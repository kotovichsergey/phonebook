# phonebook
Phone book with Slim 3

На сервере должны быть установлены composer, PHP 5.5 или выше и MySQL

1. Для использования API phonebook необходимо клонировать репозиторий или скачать zip архив на свой сервер.

2. У файла .htaccess удалить расширение и добавить точку в начале имени

3. После добавления на сервер нужно выполнить команду composer install, которая установит все зависимости прописанные в файле composer.json

4. Для создания базы MySql используйте dump phonebook.sql

   Если всё проделано верно, то будет доступн корневой запрос по url(endpoint): /phonebook с ответом
```json
   {
    "title": "Телефонная книга",
    "msg": "Привет пользователь"
   }
   ```
5. Url /phonebook/users методом GET вернёт:

   ```json
   {
    "msg": "Не удалось получить данные телефонной книги."
   }
   ```
      потому что база данных пуста.

6. Используя Url /phonebook/user/create нужно создать пользоватерей POST запросом. При этом обязательно надо передать login, password и email Значения не должны быть пустыми, не должны содержать пробелов, а email ещё должен быть валидным. После создания пользователей по GET запросу на Url /phonebook/users придёт ответ содержащий всех пользователей из базы данных.

7. Для добавления телефонов можно использовать POST запрос с Url /phonebook/user/ID/add Где ID - это id пользователя. Для этого необходимо передать phone состоящий из 12 цифр без пробелов. После добавления телефонов по GET запросу на Url /phonebook/users  придёт ответ содержащий всех пользователей с добавленными телефонами из базы данных.

8. Для работы с погодой необходимо в файле weather.php прописать API key из аккаунта на сайте openweathermap.org. Найти его можно по ссылке: https://home.openweathermap.org/api_keys

9. Для заполнения таблицы weather необходимо настроить сron, используя планировщик задач Crontab. 
     * Если нужно обновлять данные 1 раз в день, то добавьте запись в crontab: @daily {путь от корня}/phonebook/weather.php (в 00:00 каждого дня будут браться данные с API openweathermap.org)
     * Если нужно обнавлять данные 2 раза в день, то добавьте запись в crontab: 0 7,17 * * * {путь от корня}/phonebook/weather.php (данные будут обновлятьбся в 7 и 17 часов каждый день)

10. Для получения данных о погоде на сегодня используйте GET запрос с Url /phonebook/weather. 
     * Если данных о погоде на сегодня в таблице weather не будет - будет ответ:

         ```json
         {
          "msg": "На сегодня данных нет."
         }
         ```
     * Если на сегодня в таблице будет несколько записей, то клиенту возврашается последняя.
   
